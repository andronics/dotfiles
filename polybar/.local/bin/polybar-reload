#!/usr/bin/env zsh

name=$(basename $0)

# ------------------------------

_polybar_reload() {

    PROC="polybar --reload $1"

    # flock -s 200

    pgrep -f "$PROC" | xargs -I{} kill -9 {} 2>/dev/null

    while pgrep -u $UID -f "$PROC" > /dev/null; do sleep 0.5; done

    polybar --reload $1 & </dev/null >/tmp/polybar-$$.log 2>&2 200>&- &

    disown 

}

# ------------------------------

_polybar_reload "$@"

